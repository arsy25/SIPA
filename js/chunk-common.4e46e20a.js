"use strict";(globalThis["webpackChunkiotapp"]=globalThis["webpackChunkiotapp"]||[]).push([[996],{3437:(e,t,l)=>{l(1758);var o=l(8721);o.A;l(2807)},3653:(e,t,l)=>{l.d(t,{A:()=>y});var o=l(1758),i=l(9104);const s={class:"q-gutter-md"},a={class:"q-gutter-md"};function d(e,t,l,d,u,r){const n=(0,o.g2)("q-card"),c=(0,o.g2)("q-input"),m=(0,o.g2)("q-select"),p=(0,o.g2)("q-btn"),h=(0,o.g2)("q-form"),f=(0,o.g2)("q-page");return e.$q.platform.is.mobile?((0,o.uX)(),(0,o.Wv)(f,{key:0,class:"q-pa-md bg-dark"},{default:(0,o.k6)(()=>[(0,o.bF)(n,{class:"cardd q-mb-md bg-negative"},{default:(0,o.k6)(()=>t[14]||(t[14]=[(0,o.Lk)("div",{class:"row q-pa-md"},[(0,o.Lk)("div",{class:"col"},[(0,o.Lk)("div",{class:"text-h6 text-white"},"Device page"),(0,o.Lk)("p",{class:"text-white text-caption"}," Please add your device here to start monitoring and managing it in the system ")])],-1)])),_:1,__:[14]}),(0,o.bF)(n,{class:"bg-grey-10 q-pa-md cardd"},{default:(0,o.k6)(()=>[(0,o.bF)(h,{onSubmit:(0,i.D$)(r.submitRegister,["prevent"]),ref:"formRef",class:"col"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",s,[(0,o.bF)(c,{outlined:"",dense:"",modelValue:u.form.mac_address,"onUpdate:modelValue":t[0]||(t[0]=e=>u.form.mac_address=e),label:"MAC Address","label-color":"white",rules:[e=>!!e||"MAC Address is required"],class:"white-outline","lazy-rules":"",autocomplete:"off","input-class":"text-white",color:"white"},null,8,["modelValue","rules"]),(0,o.bF)(c,{outlined:"",dense:"",modelValue:u.form.device_name,"onUpdate:modelValue":t[1]||(t[1]=e=>u.form.device_name=e),label:"Device Name","label-color":"white",rules:[e=>!!e||"Device name is required"],class:"white-outline","lazy-rules":"",autocomplete:"off","input-class":"text-white",color:"white"},null,8,["modelValue","rules"]),(0,o.bF)(m,{outlined:"",dense:"",modelValue:u.form.device_types_id,"onUpdate:modelValue":t[2]||(t[2]=e=>u.form.device_types_id=e),options:u.deviceTypes,label:"Device Type","label-color":"white",class:"white-outline","input-class":"text-white",color:"white","option-label":"type_name","option-value":"id_device_types","emit-value":"","map-options":"",clearable:"",rules:[e=>null!==e||"Device type is required"]},null,8,["modelValue","options","rules"]),(0,o.bF)(c,{outlined:"",dense:"",type:"number",modelValue:u.form.latitude,"onUpdate:modelValue":t[3]||(t[3]=e=>u.form.latitude=e),modelModifiers:{number:!0},label:"Latitude","label-color":"white",rules:[e=>null!==e&&void 0!==e||"Latitude is required"],class:"white-outline","lazy-rules":"",autocomplete:"off","input-class":"text-white",color:"white"},null,8,["modelValue","rules"]),(0,o.bF)(c,{outlined:"",dense:"",type:"number",modelValue:u.form.longitude,"onUpdate:modelValue":t[4]||(t[4]=e=>u.form.longitude=e),modelModifiers:{number:!0},label:"Longitude","label-color":"white",rules:[e=>null!==e&&void 0!==e||"Longitude is required"],class:"white-outline","lazy-rules":"",autocomplete:"off","input-class":"text-white",color:"white"},null,8,["modelValue","rules"]),(0,o.bF)(m,{outlined:"",dense:"",modelValue:u.form.status,"onUpdate:modelValue":t[5]||(t[5]=e=>u.form.status=e),options:u.statusOptions,label:"Status","label-color":"white",class:"white-outline","input-class":"text-white",color:"white",rules:[e=>!!e||"Status is required"],"emit-value":"","map-options":""},null,8,["modelValue","options","rules"]),(0,o.bo)((0,o.Lk)("input",{type:"hidden","onUpdate:modelValue":t[6]||(t[6]=e=>u.form.user_id=e)},null,512),[[i.Jo,u.form.user_id]])]),(0,o.bF)(p,{label:"Register",type:"submit",color:"white",loading:u.loading,unelevated:"",class:"full-width button-cuy text-capitalize q-mt-md text-black"},null,8,["loading"])]),_:1},8,["onSubmit"])]),_:1})]),_:1})):((0,o.uX)(),(0,o.Wv)(f,{key:1,class:"q-pa-md bg-dark"},{default:(0,o.k6)(()=>[(0,o.bF)(n,{class:"cardd q-mb-md bg-negative"},{default:(0,o.k6)(()=>t[15]||(t[15]=[(0,o.Lk)("div",{class:"row q-pa-md"},[(0,o.Lk)("div",{class:"col"},[(0,o.Lk)("div",{class:"text-h6 text-white"},"Device page"),(0,o.Lk)("p",{class:"text-white text-caption"}," Please add your device here to start monitoring and managing it in the system ")])],-1)])),_:1,__:[15]}),(0,o.bF)(n,{class:"bg-grey-10 q-pa-md cardd"},{default:(0,o.k6)(()=>[(0,o.bF)(h,{onSubmit:(0,i.D$)(r.submitRegister,["prevent"]),ref:"formRef",class:"col"},{default:(0,o.k6)(()=>[(0,o.Lk)("div",a,[(0,o.bF)(c,{outlined:"",dense:"",modelValue:u.form.mac_address,"onUpdate:modelValue":t[7]||(t[7]=e=>u.form.mac_address=e),label:"MAC Address","label-color":"white",rules:[e=>!!e||"MAC Address is required"],class:"white-outline","lazy-rules":"",autocomplete:"off","input-class":"text-white",color:"white"},null,8,["modelValue","rules"]),(0,o.bF)(c,{outlined:"",dense:"",modelValue:u.form.device_name,"onUpdate:modelValue":t[8]||(t[8]=e=>u.form.device_name=e),label:"Device Name","label-color":"white",rules:[e=>!!e||"Device name is required"],class:"white-outline","lazy-rules":"",autocomplete:"off","input-class":"text-white",color:"white"},null,8,["modelValue","rules"]),(0,o.bF)(m,{outlined:"",dense:"",modelValue:u.form.device_types_id,"onUpdate:modelValue":t[9]||(t[9]=e=>u.form.device_types_id=e),options:u.deviceTypes,label:"Device Type","label-color":"white",class:"white-outline","input-class":"text-white",color:"white","option-label":"type_name","option-value":"id_device_types","emit-value":"","map-options":"",clearable:"",rules:[e=>null!==e||"Device type is required"]},null,8,["modelValue","options","rules"]),(0,o.bF)(c,{outlined:"",dense:"",type:"number",modelValue:u.form.latitude,"onUpdate:modelValue":t[10]||(t[10]=e=>u.form.latitude=e),modelModifiers:{number:!0},label:"Latitude","label-color":"white",rules:[e=>null!==e&&void 0!==e||"Latitude is required"],class:"white-outline","lazy-rules":"",autocomplete:"off","input-class":"text-white",color:"white"},null,8,["modelValue","rules"]),(0,o.bF)(c,{outlined:"",dense:"",type:"number",modelValue:u.form.longitude,"onUpdate:modelValue":t[11]||(t[11]=e=>u.form.longitude=e),modelModifiers:{number:!0},label:"Longitude","label-color":"white",rules:[e=>null!==e&&void 0!==e||"Longitude is required"],class:"white-outline","lazy-rules":"",autocomplete:"off","input-class":"text-white",color:"white"},null,8,["modelValue","rules"]),(0,o.bF)(m,{outlined:"",dense:"",modelValue:u.form.status,"onUpdate:modelValue":t[12]||(t[12]=e=>u.form.status=e),options:u.statusOptions,label:"Status","label-color":"white",class:"white-outline","input-class":"text-white",color:"white",rules:[e=>!!e||"Status is required"],"emit-value":"","map-options":""},null,8,["modelValue","options","rules"]),(0,o.bo)((0,o.Lk)("input",{type:"hidden","onUpdate:modelValue":t[13]||(t[13]=e=>u.form.user_id=e)},null,512),[[i.Jo,u.form.user_id]])]),(0,o.bF)(p,{label:"Register",type:"submit",color:"white",loading:u.loading,unelevated:"",class:"full-width button-cuy text-capitalize q-mt-md text-black"},null,8,["loading"])]),_:1},8,["onSubmit"])]),_:1})]),_:1}))}l(310),l(6724);const u={name:"RegisterPage",data(){return{form:{mac_address:"",device_name:"",device_types_id:null,latitude:null,longitude:null,status:"",user_id:null},statusOptions:[{label:"Online",value:"online"},{label:"Offline",value:"offline"}],passwordVisible:!1,loading:!1,deviceTypes:[]}},mounted(){this.fetchDeviceTypes(),this.loadUserId(),this.requestGeolocation()},methods:{resetField(){this.form={name:"",email:"",username:"",phone:"",password:""}},requestGeolocation(){"geolocation"in navigator?navigator.geolocation.getCurrentPosition(e=>{this.form.latitude=e.coords.latitude,this.form.longitude=e.coords.longitude,console.log("Latitude:",e.coords.latitude),console.log("Longitude:",e.coords.longitude)},e=>{console.warn("Geolocation error:",e.message)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0}):console.warn("Geolocation is not supported by this browser.")},loadUserId(){try{const e=JSON.parse(localStorage.getItem("user"));this.form.user_id=e?.id_user||null}catch{this.form.user_id=null}},async fetchDeviceTypes(){try{const e=localStorage.getItem("token"),t=await this.$api.get("/device-types",{headers:{Authorization:`Bearer ${e}`}});this.deviceTypes=(t.data.deviceTypes||[]).map(e=>({...e,type_name:e.type_name||e.name})),this.deviceTypes.length>0&&!this.form.device_types_id&&(this.form.device_types_id=this.deviceTypes[0].id_device_types)}catch(e){console.error("Failed to fetch device types",e),this.deviceTypes=[]}},async submitRegister(){const e=await this.$refs.formRef.validate();if(e){this.loading=!0;try{const e={mac_address:this.form.mac_address,device_name:this.form.device_name||null,device_types_id:this.form.device_types_id,latitude:null!==this.form.latitude?this.form.latitude:void 0,longitude:null!==this.form.longitude?this.form.longitude:void 0,status:this.form.status||"offline",user_id:this.form.user_id};console.log("Submitting payload:",e);const t=localStorage.getItem("token");await this.$api.post("/device-user/register",e,{headers:{Authorization:`Bearer ${t}`}});this.$q.notify({type:"positive",message:"Device registered successfully!"}),this.$refs.formRef.reset(),this.form.device_types_id=null,this.form.status=""}catch(e){this.$q.notify({type:"negative",message:e.response?.data?.message||"Failed to register device."}),console.error("Register device error:",e.response||e)}finally{this.loading=!1}}else this.$q.notify({type:"negative",message:"Please fill all required fields correctly."})}}};var r=l(2807),n=l(7716),c=l(3316),m=l(9200),p=l(9270),h=l(5801),f=l(1693),b=l(8582),g=l.n(b);const v=(0,r.A)(u,[["render",d]]),y=v;g()(u,"components",{QPage:n.A,QCard:c.A,QForm:m.A,QInput:p.A,QSelect:h.A,QBtn:f.A})}}]);